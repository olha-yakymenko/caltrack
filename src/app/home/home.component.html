<div class="home-container">
  @if (stats$ | async; as stats) {
    <div class="welcome-section">
      <h1>Witaj, {{ stats.userName }}!</h1>
      @if (stats.isPremium) {
        <span class="premium-badge">â­ PREMIUM</span>
      }
    </div>

    @if (stats.isPremium && stats.isActive) {
      <div class="premium-features">
        <button (click)="toggleCalculator()" class="premium-btn">
          @if (showCalculator) {
            âœ• Zamknij kalkulator
          } @else {
            ğŸ§® OtwÃ³rz kalkulator kalorii
          }
        </button>
      </div>
    }

    @if (!stats.isActive) {
      <div class="warning-banner">
        âš ï¸ Twoje konto jest zawieszone. NiektÃ³re funkcje mogÄ… byÄ‡ niedostÄ™pne.
      </div>
    }

    <div class="calorie-circle-wrapper">
      <div class="calorie-ring" [style.background]="getRingGradient(stats.percent, stats.remaining < 0)">
        <div class="inner-circle">
          <span class="remaining-value">{{ stats.remaining > 0 ? stats.remaining : 0 }}</span>
          <span class="remaining-label">PozostaÅ‚o kcal</span>
        </div>
      </div>
    </div>

    <div class="summary-cards">
      <div class="card">
        <p>Cel dzienny</p>
        <strong>{{ stats.limit }} kcal</strong>
      </div>
      <div class="card">
        <p>Zjedzone</p>
        <strong>{{ stats.consumed }} kcal</strong>
      </div>
      <div class="card">
        <p>Procent celu</p>
        <strong>{{ stats.percent | number:'1.0-0' }}%</strong>
      </div>
      @if (stats.remaining < 0) {
        <div class="card warning">
          <p>Przekroczono limit</p>
          <strong>{{ -stats.remaining }} kcal</strong>
        </div>
      }
    </div>

    @if (showCalculator && stats.isPremium && stats.isActive) {
      <div class="calculator-container">
        <app-calorie-calculator
          (calculate)="onCaloriesCalculated($event)"
          (close)="onCalculatorClose()"
        ></app-calorie-calculator>
      </div>
    }
    
  } @else {
    <div class="login-prompt">
      <h2>ğŸ ÅšledÅº swoje kalorie!</h2>
      <p>Aby zobaczyÄ‡ swoje statystyki i zarzÄ…dzaÄ‡ posiÅ‚kami, zaloguj siÄ™ do konta.</p>
      
      <div class="prompt-actions">
        <a routerLink="/login" class="login-btn">Zaloguj siÄ™</a>
        <a routerLink="/register" class="register-btn">ZaÅ‚Ã³Å¼ konto</a>
      </div>
      
      <div class="features">
        <h3>ğŸ“‹ Co zyskujesz?</h3>
        <div class="feature-list">
          <div class="feature">
            <div class="feature-icon">ğŸ“Š</div>
            <div class="feature-content">
              <h4>Åšledzenie kalorii</h4>
              <p>Monitoruj dzienne spoÅ¼ycie kalorii w czasie rzeczywistym</p>
            </div>
          </div>
          
          <div class="feature">
            <div class="feature-icon">ğŸ¯</div>
            <div class="feature-content">
              <h4>OsiÄ…ganie celÃ³w</h4>
              <p>Ustalaj cele i Å›ledÅº swoje postÄ™py</p>
            </div>
          </div>
          
          <div class="feature">
            <div class="feature-icon">â­</div>
            <div class="feature-content">
              <h4>Funkcje Premium</h4>
              <p>Kalkulator zapotrzebowania, planowanie posiÅ‚kÃ³w, zaawansowana analiza</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  }
</div>