

<nav>
    <a routerLink="/" 
       routerLinkActive="active" 
       [routerLinkActiveOptions]="{ exact: true }"
       [appDisabledIfInactive]="true">  
      {{ 'NAV.HOME' | translate }}
    </a>
    
    <a routerLink="/info" 
       routerLinkActive="active" 
       [routerLinkActiveOptions]="{ exact: true }"
       [appDisabledIfInactive]="true">  
      {{ 'NAV.INFO' | translate }}
    </a>
    
    <a routerLink="/meal/list" 
       routerLinkActive="active" 
       [routerLinkActiveOptions]="{ exact: true }"
       [appDisabledIfInactive]="true">  
      {{ 'NAV.MEALS' | translate }}
    </a>
    
    <a routerLink="/meal/form" 
       routerLinkActive="active" 
       [routerLinkActiveOptions]="{ exact: true }"
       [appDisabledIfInactive]="true">  
      {{ 'NAV.ADD_MEAL' | translate }}
    </a>
    
    <button (click)="back()">  
      {{ 'NAV.BACK' | translate }}
    </button>

    @if (authService.currentUser$ | async; as user) {
      <div>{{ 'COMMON.WELCOME' | translate }}, <strong>{{ user.name }}</strong> ({{ user.email }})</div>
      
      @if (user.role === 'admin') {
        <a routerLink="/admin" [appDisabledIfInactive]="true">  
          {{ 'NAV.ADMIN' | translate }}
        </a>
      }
      
      <button 
        class="settings-btn"
        (click)="openSettings()"
        [attr.aria-label]="'NAV.SETTINGS' | translate"
        [title]="'NAV.SETTINGS' | translate"
        [appDisabledIfInactive]="true"  
      >
        ‚öôÔ∏è {{ 'NAV.SETTINGS' | translate }}
      </button>

      <div class="language-selector">
        <select 
          [(ngModel)]="currentLanguage" 
          (change)="changeLanguage(currentLanguage)"
          class="language-select"
        >
          @for (lang of availableLanguages; track lang.code) {
            <option [value]="lang.code">
              {{ lang.flag }} {{ 'LANGUAGES.' + lang.code.toUpperCase() | translate }}
            </option>
          }
        </select>
      </div>

      <button 
        class="theme-toggle"
        (click)="toggleTheme()"
        [attr.aria-label]="isDarkTheme ? ('THEME.SWITCH_TO_LIGHT' | translate) : ('THEME.SWITCH_TO_DARK' | translate)"
        [title]="isDarkTheme ? ('THEME.SWITCH_TO_LIGHT' | translate) : ('THEME.SWITCH_TO_DARK' | translate)"
      >
        <span class="theme-toggle-icon" [class.dark]="isDarkTheme">
          {{ isDarkTheme ? 'üåô' : '‚òÄÔ∏è' }}
        </span>
        <span class="theme-toggle-text">
          {{ isDarkTheme ? ('THEME.DARK_MODE' | translate) : ('THEME.LIGHT_MODE' | translate) }}
        </span>
      </button>

      <button (click)="authService.logout()">  
        {{ 'NAV.LOGOUT' | translate }}
      </button>
    } @else {
      <a routerLink="/login">{{ 'NAV.LOGIN' | translate }}</a>
    }
</nav>

@if (showSettings && userSettings.name && userSettings.email) {
  <app-user-settings
    [name]="userSettings.name"
    [email]="userSettings.email"
    (save)="saveUserSettings($event)"
    (closed)="closeSettings()"
  ></app-user-settings>
}